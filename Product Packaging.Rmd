---
title: '**Project Machine Learning for Retail: Product Packaging**'
author: "Author: Fitria Dwi Wulandari (wulan391@sci.ui.ac.id) - September 21, 2021."
output:
  html_document: default
---
***
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##### **Problems**: 
1. More competitors.
1. There are still many products that are in abundant stock.

##### **Goals**: 

Create innovative packages, where products that previously did not sell well but have market share can be packaged and sold.

##### **Responsibilities**: 

In order to increase profits and customer loyalty, companies have to identify attractive product packages.

1. Gain insights from the top 10 and bottom 10 products sold.
1. Get a list of all product package combinations with strong correlations.
1. Get a list of all product package combinations with a specific item.


***
##### **Import Library**
```{r message=FALSE}
library(arules)
```
##### **Import Dataset**

**dataset**: 
- transaction data for 3 months 
- consisting of 2 variables (transaction code, product name)

```{r}
transaksi_retail <- read.transactions(file="https://storage.googleapis.com/dqlab-dataset/transaksi_dqlab_retail.tsv", format="single", sep="\t", cols=c(1,2), skip=1)
transaksi_retail
```

##### **Top 10 Product**
```{r}
top_10 <- sort(itemFrequency(transaksi_retail, type="absolute"), decreasing = TRUE)[1:10]
top_10 <- data.frame("Product Names"=names(top_10), "Total"=top_10, row.names=NULL)
print(top_10)
```

##### **Bottom 10 Product**
```{r}
bottom_10 <- sort(itemFrequency(transaksi_retail, type="absolute"), decreasing = FALSE)[1:10]
bottom_10 <- data.frame("Product Names"=names(bottom_10), "Total"=bottom_10, row.names=NULL)
print(bottom_10)
```

##### **Finding Attractive Product Combinations**

The 10 most "attractive" product combination packages with the following conditions:

1. Having close associations or relationships.
1. A minimum of 2 product combinations and a maximum of 3 items.
1. The product combination appears in at least 10 of all transactions. 
1. Have a minimum confidence level of 50 percent.

```{r}
apriori_rules <- apriori(transaksi_retail, parameter = list(supp=10/nrow(transaksi_retail), minlen=2, maxlen=3, confidence=0.5))
               
data_kombinasi <- sort(apriori_rules, by='lift', decreasing = TRUE)[1:10]
inspect(data_kombinasi)
```

```{r}
write(data_kombinasi, file="kombinasi_retail.txt")
```

##### **Finding for Product Packages that can be paired with Slow-Moving Items**

Slow-moving items are products whose sales movements are slow or not fast enough. This will be problematic if the product items are still piling up. The reason why it doesn't sell may be because the price is not good and it is rarely needed if sold individually.

**Solution**: Create an attractive package consisting of slow-moving products and other products that have strong associations with these slow-moving products. The two product items are "Tas Makeup" and "Baju Renang Pria Anak-anak". The following are the conditions for  product combination packages:

1. Having close associations or relationships.
1. A minimum of 2 product combinations and a maximum of 3 items.
1. The product combination appears in at least 10 of all transactions. 
1. Have a minimum confidence level of 10 percent.

```{r}
apriori_rules2 <- apriori(transaksi_retail, parameter = list(supp=10/nrow(transaksi_retail), minlen=2, maxlen=3, confidence=0.1))

item_slow1 <- subset(apriori_rules2, rhs %in% 'Tas Makeup' & lift>1)
item_slow1 <- sort(item_slow1, by='lift', decreasing = TRUE)[1:3]

item_slow2 <- subset(apriori_rules2, rhs %in% 'Baju Renang Pria Anak-anak' & lift>1)
item_slow2 <- sort(item_slow2, by='lift', decreasing = TRUE)[1:3]

apriori_rules3 <- c(item_slow1,item_slow2)
inspect(apriori_rules3)
```

```{r}
write(apriori_rules3,file= "kombinasi_retail_slow_moving.txt")
```
